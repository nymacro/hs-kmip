{-# LANGUAGE OverloadedStrings #-}
-- naming convention: kmip_<KMIP VERSION>__<SECTION VERSION>_<REQUEST/RESPONSE>
module Spec where

import Ttlv.Tag
import Ttlv.Data
import Ttlv.Parser

import Test.Hspec

import qualified Data.ByteString.Lazy as L
import qualified Data.ByteString.Base16 as B16

fromHex x = L.fromChunks [fst $ B16.decode x]

kmip_1_0__3_1_1_create_request = fromHex "42007801000001204200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000000000000042000D0200000004000000010000000042000F01000000D842005C0500000004000000010000000042007901000000C04200570500000004000000020000000042009101000000A8420008010000003042000A070000001743727970746F6772617068696320416C676F726974686D0042000B05000000040000000300000000420008010000003042000A070000001443727970746F67726170686963204C656E6774680000000042000B02000000040000008000000000420008010000003042000A070000001843727970746F67726170686963205573616765204D61736B42000B02000000040000000C00000000"
kmip_1_0__3_1_1_create_response = fromHex "42007B01000000C042007A0100000048420069010000002042006A0200000004000000010000000042006B020000000400000000000000004200920900000008000000004AFBE7C242000D0200000004000000010000000042000F010000006842005C0500000004000000010000000042007F0500000004000000000000000042007C010000004042005705000000040000000200000000420094070000002466633838333364652D373064322D346563652D623036332D66656465336133633539666500000000"
kmip_1_0__3_1_1_destroy_request = fromHex "42007801000000904200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000000000000042000D0200000004000000010000000042000F010000004842005C050000000400000014000000004200790100000030420094070000002466633838333364652D373064322D346563652D623036332D66656465336133633539666500000000"
kmip_1_0__3_1_1_destroy_response = fromHex "42007B01000000B042007A0100000048420069010000002042006A0200000004000000010000000042006B020000000400000000000000004200920900000008000000004AFBE7C342000D0200000004000000010000000042000F010000005842005C0500000004000000140000000042007F0500000004000000000000000042007C0100000030420094070000002466633838333364652D373064322D346563652D623036332D66656465336133633539666500000000"


kmip_1_0__3_1_2_register_request = fromHex "42007801000001C84200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000000000000042000D0200000004000000010000000042000F010000018042005C0500000004000000030000000042007901000001684200570500000004000000060000000042009101000000004200900100000148420008010000002842000A070000000C4F626A6563742047726F75700000000042000B070000000647726F7570310000420008010000005842000A07000000204170706C69636174696F6E20537065636966696320496E666F726D6174696F6E42000B0100000028420003070000000373736C0000000000420002070000000F7777772E6578616D706C652E636F6D00420008010000003042000A0700000013436F6E7461637420496E666F726D6174696F6E000000000042000B07000000034A6F650000000000420008010000003042000A0700000009782D507572706F73650000000000000042000B070000000D64656D6F6E7374726174696F6E000000420008010000004042000A07000000044E616D650000000042000B0100000028420055070000000954656D706C617465310000000000000042005405000000040000000100000000"
kmip_1_0__3_1_2_register_response = fromHex "42007B01000000B042007A0100000048420069010000002042006A0200000004000000010000000042006B020000000400000000000000004200920900000008000000004AFBE7C442000D0200000004000000010000000042000F010000005842005C0500000004000000030000000042007F0500000004000000000000000042007C0100000030420094070000002461366562626236662D346335342D346262622D616432392D62653662616434656361643500000000"
kmip_1_0__3_1_2_create_request = fromHex "42007801000001504200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000000000000042000D0200000004000000010000000042000F010000010842005C0500000004000000010000000042007901000000F04200570500000004000000020000000042009101000000D84200530100000028420055070000000954656D706C617465310000000000000042005405000000040000000100000000420008010000003042000A070000001743727970746F6772617068696320416C676F726974686D0042000B05000000040000000300000000420008010000003042000A070000001443727970746F67726170686963204C656E6774680000000042000B02000000040000008000000000420008010000003042000A070000001843727970746F67726170686963205573616765204D61736B42000B02000000040000000C00000000"
kmip_1_0__3_1_2_create_response = fromHex "42007B01000000C042007A0100000048420069010000002042006A0200000004000000010000000042006B020000000400000000000000004200920900000008000000004AFBE7C542000D0200000004000000010000000042000F010000006842005C0500000004000000010000000042007F0500000004000000000000000042007C010000004042005705000000040000000200000000420094070000002436316231303631342D643862352D343666392D386431372D32666136656131643734376100000000"
kmip_1_0__3_1_2_get_attributes_request = fromHex "42007801000001084200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000000000000042000D0200000004000000010000000042000F01000000C042005C05000000040000000B0000000042007901000000A8420094070000002436316231303631342D643862352D343666392D386431372D3266613665613164373437610000000042000A070000000C4F626A6563742047726F75700000000042000A07000000204170706C69636174696F6E20537065636966696320496E666F726D6174696F6E42000A0700000013436F6E7461637420496E666F726D6174696F6E000000000042000A0700000009782D507572706F736500000000000000"
kmip_1_0__3_1_2_get_attributes_response = fromHex "42007B01000001B042007A0100000048420069010000002042006A0200000004000000010000000042006B020000000400000000000000004200920900000008000000004AFBE7C642000D0200000004000000010000000042000F010000015842005C05000000040000000B0000000042007F0500000004000000000000000042007C0100000130420094070000002436316231303631342D643862352D343666392D386431372D32666136656131643734376100000000420008010000002842000A070000000C4F626A6563742047726F75700000000042000B070000000647726F7570310000420008010000005842000A07000000204170706C69636174696F6E20537065636966696320496E666F726D6174696F6E42000B0100000028420003070000000373736C0000000000420002070000000F7777772E6578616D706C652E636F6D00420008010000003042000A0700000013436F6E7461637420496E666F726D6174696F6E000000000042000B07000000034A6F650000000000420008010000003042000A0700000009782D507572706F73650000000000000042000B070000000D64656D6F6E7374726174696F6E000000"
kmip_1_0__3_1_2_destroy_request1 = fromHex "42007801000000904200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000000000000042000D0200000004000000010000000042000F010000004842005C050000000400000014000000004200790100000030420094070000002436316231303631342D643862352D343666392D386431372D32666136656131643734376100000000"
kmip_1_0__3_1_2_destroy_response1 = fromHex "42007B01000000B042007A0100000048420069010000002042006A0200000004000000010000000042006B020000000400000000000000004200920900000008000000004AFBE7C642000D0200000004000000010000000042000F010000005842005C0500000004000000140000000042007F0500000004000000000000000042007C0100000030420094070000002436316231303631342D643862352D343666392D386431372D32666136656131643734376100000000"
kmip_1_0__3_1_2_destroy_request2 = fromHex "42007801000000904200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000000000000042000D0200000004000000010000000042000F010000004842005C050000000400000014000000004200790100000030420094070000002461366562626236662D346335342D346262622D616432392D62653662616434656361643500000000"
kmip_1_0__3_1_2_destroy_response2 = fromHex "42007B01000000B042007A0100000048420069010000002042006A0200000004000000010000000042006B020000000400000000000000004200920900000008000000004AFBE7C642000D0200000004000000010000000042000F010000005842005C0500000004000000140000000042007F0500000004000000000000000042007C0100000030420094070000002461366562626236662D346335342D346262622D616432392D62653662616434656361643500000000"


test :: IO ()
test = hspec spec

main = do
  let x = decodeTtlv kmip_1_0__3_1_1_create_request
  putStrLn $ show x
  putStrLn "blah"

xxx :: IO ()
xxx = do
  -- putStrLn $ show $ decodeTtlv kmip_1_0__3_1_1_create_request
  putStrLn $ show $ decodeTtlv $ fromHex "42007B0700000018666666666666666666666666666666666666666666666666"


spec :: Spec
spec = do
  describe "Use Cases" $ do
    describe "1.0" $ do
      describe "3.1.1 Create / Destroy" $ do
        it "create request" $ do
          encodeTtlv (decodeTtlv kmip_1_0__3_1_1_create_request) `shouldBe` kmip_1_0__3_1_1_create_request
        it "create response" $ do
          encodeTtlv (decodeTtlv kmip_1_0__3_1_1_create_response) `shouldBe` kmip_1_0__3_1_1_create_response
        it "destroy request" $ do
          encodeTtlv (decodeTtlv kmip_1_0__3_1_1_destroy_request) `shouldBe` kmip_1_0__3_1_1_destroy_request
        it "destroy response" $ do
          encodeTtlv (decodeTtlv kmip_1_0__3_1_1_destroy_response) `shouldBe` kmip_1_0__3_1_1_destroy_response
      describe "3.1.2 Register / Create / Get Attributes / Destroy" $ do
        it "register request" $ do
          encodeTtlv (decodeTtlv kmip_1_0__3_1_2_register_request) `shouldBe` kmip_1_0__3_1_2_register_request
        it "register response" $ do
          encodeTtlv (decodeTtlv kmip_1_0__3_1_2_register_response) `shouldBe` kmip_1_0__3_1_2_register_response
        it "create request" $ do
          encodeTtlv (decodeTtlv kmip_1_0__3_1_2_create_request) `shouldBe` kmip_1_0__3_1_2_create_request
        it "create response" $ do
          encodeTtlv (decodeTtlv kmip_1_0__3_1_2_create_response) `shouldBe` kmip_1_0__3_1_2_create_response
        it "get attributes request" $ do
          encodeTtlv (decodeTtlv kmip_1_0__3_1_2_get_attributes_request) `shouldBe`  kmip_1_0__3_1_2_get_attributes_request
        it "get attributes response" $ do
          encodeTtlv (decodeTtlv kmip_1_0__3_1_2_get_attributes_response) `shouldBe`  kmip_1_0__3_1_2_get_attributes_response
        it "destroy 1 request" $ do
          encodeTtlv (decodeTtlv kmip_1_0__3_1_2_destroy_request1) `shouldBe` kmip_1_0__3_1_2_destroy_request1
        it "destroy 1 response" $ do
          encodeTtlv (decodeTtlv kmip_1_0__3_1_2_destroy_response1) `shouldBe` kmip_1_0__3_1_2_destroy_response1
